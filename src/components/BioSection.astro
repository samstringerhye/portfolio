---
import type { HeadingTag, TextTag, TypographyRole } from '../types/typography'
import { animations } from '../data/tokens'

interface Props {
  headline: string
  body: string
  headlineTag?: HeadingTag
  headlineRole?: TypographyRole
  bodyTag?: TextTag
  bodyRole?: TypographyRole
}

const {
  headline, body,
  headlineTag = 'h2', headlineRole = 'prose-title-lg',
  bodyTag = 'p', bodyRole = 'prose-subhead-lg',
} = Astro.props as Props
const HeadlineTag = headlineTag as any
const BodyTag = bodyTag as any

const revealCfg = animations.textReveal
const bioInitBlur = `${revealCfg.initialBlur}px`
---

<section class="bio-section" aria-label="About">
  <div class="bio-inner" data-reveal-group>
    <div class="bio-left">
      <HeadlineTag class:list={["bio-headline", `typo-${headlineRole}`]} data-reveal>{headline}</HeadlineTag>
    </div>
    <div class="bio-divider"></div>
    <div class="bio-right">
      <svg class="bio-crosshair bio-crosshair-tl" aria-hidden="true" viewBox="0 0 20 20"><circle cx="10" cy="10" r="5" fill="none" /><line x1="10" y1="0" x2="10" y2="20" /><line x1="0" y1="10" x2="20" y2="10" /></svg>
      <svg class="bio-crosshair bio-crosshair-tr" aria-hidden="true" viewBox="0 0 20 20"><circle cx="10" cy="10" r="5" fill="none" /><line x1="10" y1="0" x2="10" y2="20" /><line x1="0" y1="10" x2="20" y2="10" /></svg>
      <svg class="bio-crosshair bio-crosshair-bl" aria-hidden="true" viewBox="0 0 20 20"><circle cx="10" cy="10" r="5" fill="none" /><line x1="10" y1="0" x2="10" y2="20" /><line x1="0" y1="10" x2="20" y2="10" /></svg>
      <svg class="bio-crosshair bio-crosshair-br" aria-hidden="true" viewBox="0 0 20 20"><circle cx="10" cy="10" r="5" fill="none" /><line x1="10" y1="0" x2="10" y2="20" /><line x1="0" y1="10" x2="20" y2="10" /></svg>
      <BodyTag class:list={["bio-text", `typo-${bodyRole}`]} data-reveal>{body}</BodyTag>
    </div>
  </div>
</section>

<style define:vars={{ bioInitBlur }}>
  .bio-section {
    position: relative;
    z-index: 1;
  }

  .bio-inner {
    display: grid;
    grid-template-columns: 1fr auto 2fr;
    width: 100%;
    padding-inline: var(--page-margin);
  }

  .bio-left {
    display: flex;
    align-items: center;
    justify-content: center;
    padding-left: var(--content-inset);
    padding-right: var(--grid-gutter);
  }

  .bio-headline {
    color: var(--color-text-primary);
    margin: 0;
    opacity: 0;
    filter: blur(var(--bioInitBlur));
  }

  .bio-divider {
    width: var(--border-width-1);
    background: var(--color-accent);
  }

  .bio-right {
    position: relative;
    display: flex;
    align-items: center;
    padding: calc(var(--content-inset) * 4) var(--content-inset);
  }

  .bio-crosshair {
    position: absolute;
    width: 1.5rem;
    height: 1.5rem;
    stroke: var(--color-accent);
    stroke-width: var(--border-width-1);
  }

  .bio-crosshair-tl {
    top: calc(var(--content-inset) / 2);
    left: calc(var(--content-inset) / 2);
  }

  .bio-crosshair-tr {
    top: calc(var(--content-inset) / 2);
    right: calc(var(--content-inset) / 2);
  }

  .bio-crosshair-bl {
    bottom: calc(var(--content-inset) / 2);
    left: calc(var(--content-inset) / 2);
  }

  .bio-crosshair-br {
    bottom: calc(var(--content-inset) / 2);
    right: calc(var(--content-inset) / 2);
  }

  .bio-text {
    color: var(--color-text-primary);
    margin: 0;
    width: 100%;
  }

  .bio-text {
    opacity: 0;
    filter: blur(var(--bioInitBlur));
  }

  @media (--2x) {
    .bio-inner {
      grid-template-columns: 1fr;
    }

    .bio-left {
      padding-block: var(--content-inset);
      padding-inline: var(--content-inset);
    }

    .bio-right {
      padding-inline: var(--content-inset);
    }

    .bio-divider {
      width: 100%;
      height: var(--border-width-1);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .bio-headline,
    .bio-text {
      opacity: 1;
      transform: none;
      filter: none;
    }
  }
</style>
